<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xiliulou.electricity.mapper.merchant.MerchantPromotionDayRecordMapper">
    <sql id="basics_field">
        id, merchant_id, inviter_uid, day_first_money, day_renew_money, day_balance_money, type, date, tenant_id, del_flag, create_time, update_time, remark
    </sql>
    
    <select id="selectListByTenantId" resultType="com.xiliulou.electricity.vo.merchant.MerchantPromotionMonthDetailVO">
        select tenant_id,
               any_value(merchant_id)       as merchant_id,
               any_value(inviter_uid)       as inviter_uid,
               sum(day_first_money)         as month_first_money,
               sum(day_renew_money)         as month_renew_money,
               any_value(day_first_money)   as day_first_money,
               any_value(day_renew_money)   as day_renew_money,
               any_value(day_balance_money) as day_balance_money,
               any_value(type)              as type,
               any_value(date) as date
        from t_merchant_promotion_day_record
        where tenant_id = #{tenantId}
          and del_flag = 0
          and date &gt;= #{startDate}
          and date &lt;= #{endDate}
        group by tenant_id, merchant_id
    </select>

</mapper>
