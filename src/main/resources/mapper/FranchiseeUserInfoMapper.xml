<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xiliulou.electricity.mapper.FranchiseeUserInfoMapper">


    <update id="unBind">
        update t_franchisee_user_info
        set service_status = #{serviceStatus},
        now_electricity_battery_sn = #{nowElectricityBatterySn},
        <if test="initElectricityBatterySn != null">
            init_electricity_battery_sn = #{initElectricityBatterySn},
        </if>
        update_time = #{updateTime}
        where id = #{id} and del_flag=0
    </update>


    <update id="updateRefund">
		update t_franchisee_user_info
        set service_status = #{serviceStatus},
            order_id = #{orderId},
            battery_deposit = #{batteryDeposit},
            update_time = #{updateTime}
        where id = #{id} and del_flag=0
	</update>


    <update id="updateByUserInfoId">
        update t_franchisee_user_info
        set now_electricity_battery_sn = #{nowElectricityBatterySn},
        <if test="serviceStatus != null">
            service_status = #{serviceStatus},
        </if>
        <if test="initElectricityBatterySn != null">
            init_electricity_battery_sn = #{initElectricityBatterySn},
        </if>
        <if test="batteryServiceFeeStatus != null">
            battery_service_fee_status = #{batteryServiceFeeStatus},
        </if>
        update_time = #{updateTime}
        where user_info_id = #{userInfoId} and del_flag=0
    </update>

    <update id="updateByOrder">
		update t_franchisee_user_info
		set service_status = #{serviceStatus},
		update_time = #{updateTime},
		battery_deposit = #{batteryDeposit},
		order_id = #{orderId},
		franchisee_id = #{franchiseeId},
		model_type = #{modelType},
		battery_type = #{batteryType},
		card_id = #{cardId},
		card_name = #{cardName},
		card_type = #{cardType},
		member_card_expire_time = #{memberCardExpireTime},
		remaining_number = #{remainingNumber}
		where id = #{id} and del_flag=0
	</update>


    <update id="updateOrderByUserInfoId">
		update t_franchisee_user_info
		set service_status = #{serviceStatus},
		update_time = #{updateTime},
		battery_deposit = #{batteryDeposit},
		order_id = #{orderId},
		franchisee_id = #{franchiseeId},
		model_type = #{modelType},
		battery_type = #{batteryType},
		card_id = #{cardId},
		card_name = #{cardName},
		card_type = #{cardType},
		member_card_expire_time = #{memberCardExpireTime},
		remaining_number = #{remainingNumber}
		where user_info_id = #{userInfoId} and del_flag=0
	</update>


    <select id="queryFranchiseeUserInfoByUid" resultType="com.xiliulou.electricity.entity.FranchiseeUserInfo">
        select tf.id ,tf.user_info_id,tf.service_status,tf.franchisee_id,tf.card_id,tf.card_name,tf.card_type,tf.member_card_expire_time,
                tf.remaining_number,tf.init_electricity_battery_sn,tf.now_electricity_battery_sn,tf.battery_deposit,tf.order_id,tf.del_flag,
                tf.create_time,tf.update_time,tf.tenant_id,tf.model_type,tf.battery_type,tf.battery_service_fee_status,tf.battery_service_fee_generate_time
                from t_franchisee_user_info tf
                left join t_user_info tu on tf.user_info_id=tu.id where tu.uid=#{uid} and tf.del_flag=0
    </select>


    <update id="updateRentCar">
        update t_franchisee_user_info
        set rent_car_status = #{rentCarStatus},
            bind_car_id=#{bindCarId},
            update_time = #{updateTime}
        where id = #{id} and del_flag=0
    </update>

</mapper>
