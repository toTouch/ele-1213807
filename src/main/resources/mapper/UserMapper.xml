<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xiliulou.electricity.mapper.UserMapper">



	<!--通过主键修改数据-->
	<update id="updateUserById">
		update t_user
		<set>
			<if test="phone != null">
				phone = #{phone},
			</if>
			<if test="name != null">
				name = #{name},
			</if>
			<if test="gender != null">
				gender = #{gender},
			</if>
			<if test="delFlag != null">
				del_flag = #{delFlag},
			</if>
			<if test="createTime != null">
				create_time = #{createTime},
			</if>
			<if test="updateTime != null">
				update_time = #{updateTime},
			</if>
		</set>
		where uid = #{uid}
	</update>



	<select id="queryListUserByCriteria" resultType="com.xiliulou.electricity.entity.User">
		select uid, phone, avatar, name, gender, del_flag, lock_flag, user_type, create_time, update_time,
		city,province,address,cid,ref_id,lang,tenant_id,data_type
		from t_user
		<where>
			del_flag = 0
			<if test="uid != null">
				and uid = #{uid}
			</if>
			<if test="name != null and name != '' ">
				and name like concat('%',#{name},'%')
			</if>
			<if test="type != null and type !=-1">
				and user_type = #{type}
			</if>
			<if test="type != null and type ==-1">
				and user_type !=11
			</if>
			<if test="phone != null and phone != ''">
				and phone=#{phone}
			</if>
			<if test="startTime != null">
				and create_time &gt;=#{startTime}
			</if>
			<if test="endTime != null">
				and create_time &lt;=#{endTime}
			</if>
			<if test="tenantId != null">
				and tenant_id = #{tenantId}
			</if>
		</where>
		order by create_time desc
		limit #{offset}, #{size}
	</select>


	<select id="queryCount" resultType="java.lang.Integer">
		select COUNT(1)
		from t_user
		<where>
			del_flag = 0
			<if test="uid != null">
				and uid = #{uid}
			</if>
			<if test="name != null and name != '' ">
				and name like concat('%',#{name},'%')
			</if>
			<if test="type != null and type !=-1">
				and user_type = #{type}
			</if>
			<if test="type != null and type ==-1">
				and user_type !=11
			</if>
			<if test="phone != null and phone != ''">
				and phone=#{phone}
			</if>
			<if test="startTime != null">
				and create_time &gt;=#{startTime}
			</if>
			<if test="endTime != null">
				and create_time &lt;=#{endTime}
			</if>
			<if test="tenantId != null">
				and tenant_id = #{tenantId}
			</if>
		</where>
	</select>

</mapper>
