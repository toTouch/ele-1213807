<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xiliulou.electricity.mapper.CouponPackageOperateRecordMapper">


    <insert id="batchInsertRecord" keyProperty="id" useGeneratedKeys="true">
        insert into t_coupon_package_operate_record
        (package_id,uid,name,phone,issued_uid,operateName,tenant_id,create_time,update_time)
        values
        <foreach collection="list" item="item" index="index" separator=",">
            (#{item.packageId},#{item.uid},#{item.name},#{item.phone},#{item.issuedUid},#{item.operateName},#{item.tenantId},#{item.createTime},#{item.updateTime})
        </foreach>
    </insert>

    <select id="queryPageRecordList" resultType="com.xiliulou.electricity.entity.CouponPackageOperateRecord">
        select
        id,
        package_id,
        uid,
        name,
        phone,
        issued_uid,
        operateName,
        tenant_id,
        create_time,
        update_time
        from t_coupon_package_operate_record
        where tenant_id = #{tenantId}
        <if test="packageId != null">
            and package_id = #{packageId}
        </if>
        <if test="phone != null and phone != ''">
            and phone = #{phone}
        </if>
        <if test="name != null and name != ''">
            and name like concat('%',#{name},'%')
        </if>
        <if test="beginTime != null">
            and create_time &gt;= #{beginTime}
        </if>
        <if test="endTime != null">
            and create_time &lt;= #{endTime}
        </if>
        order by id desc
        limit #{offset},#{size}
    </select>

    <select id="queryRecordCount" resultType="integer">
        select count(1)
        from t_coupon_package_operate_record
        where tenant_id = #{tenantId}
        <if test="packageId != null">
            and package_id = #{packageId}
        </if>
        <if test="phone != null and phone != ''">
            and phone = #{phone}
        </if>
        <if test="name != null and name != ''">
            and name like concat('%',#{name},'%')
        </if>
        <if test="beginTime != null">
            and create_time &gt;= #{beginTime}
        </if>
        <if test="endTime != null">
            and create_time &lt;= #{endTime}
        </if>
        order by id desc
    </select>

</mapper>
