<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xiliulou.electricity.mapper.WechatWithdrawalCertificateMapper">
    
    <sql id="base_column">
        id
        ,
        tenant_id,
        certificate_value,
        upload_time,
        pay_params_id,
        franchisee_id,
        del_flag
    </sql>
    
    
    <select id="selectByTenantIdAndFranchiseeId"
        resultType="com.xiliulou.electricity.entity.WechatWithdrawalCertificate">
        select
        <include refid="base_column"/>
        from t_wechat_withdrawal_certificate
        where tenant_id = #{tenantId} and franchisee_id = #{franchiseeId} and del_flag=0
    </select>
    
    <select id="selectListByTenantIdAndFranchiseeId" resultType="com.xiliulou.electricity.entity.WechatWithdrawalCertificate">
        select
        <include refid="base_column"/>
        from t_wechat_withdrawal_certificate
        where
        del_flag = 0
        and (tenant_id,franchisee_id)
        in
        <foreach collection="list" item="item" separator="," open="(" close=")">
            (#{item.tenantId},#{item.franchiseeId})
        </foreach>
    </select>
    
    <update id="logicalDeleteByPayParamsId">
        update
            t_wechat_withdrawal_certificate
        set del_flag = 1
        where pay_params_id = #{payParamsId}
          and tenant_id = #{tenantId}
    </update>
    
    <update id="updateByIdAndTenantId">
        update t_wechat_withdrawal_certificate
        <set>
            <if test="certificateValue != null">
                certificate_value = #{certificateValue},
            </if>
            <if test="uploadTime != null">
                upload_time = #{uploadTime},
            </if>
        </set>
        where id = #{id} and tenant_id = #{tenantId}
    </update>

</mapper>
