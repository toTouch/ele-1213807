<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xiliulou.electricity.mapper.ElectricityConfigMapper">
    
    <resultMap type="com.xiliulou.electricity.entity.ElectricityConfig" id="ElectricityConfigMap">
        <result property="id" column="id" jdbcType="INTEGER"/>
        <result property="name" column="name" jdbcType="VARCHAR"/>
        <result property="createTime" column="create_time" jdbcType="INTEGER"/>
        <result property="updateTime" column="update_time" jdbcType="INTEGER"/>
        <result property="orderTime" column="order_time" jdbcType="INTEGER"/>
        <result property="isManualReview" column="is_manual_review" jdbcType="INTEGER"/>
        <result property="tenantId" column="tenant_id" jdbcType="INTEGER"/>
        <result property="isWithdraw" column="is_withdraw" jdbcType="INTEGER"/>
        <result property="isOpenDoorLock" column="is_open_door_lock" jdbcType="INTEGER"/>
        <result property="isBatteryReview" column="is_battery_review" jdbcType="INTEGER"/>
        <result property="disableMemberCard" column="disable_member_card" jdbcType="INTEGER"/>
        <result property="isLowBatteryExchange" column="is_low_battery_exchange" jdbcType="INTEGER"/>
        <result property="isSelectionExchange" column="is_selection_exchange" jdbcType="INTEGER"/>
        <result property="lowBatteryExchangeModel" column="low_battery_exchange_model" jdbcType="VARCHAR"/>
        <result property="isEnableSelfOpen" column="is_enable_self_open" jdbcType="INTEGER"/>
        <result property="isEnableReturnBoxCheck" column="is_enable_return_box_check" jdbcType="INTEGER"/>
        <result property="isMoveFranchisee" column="is_move_franchisee" jdbcType="INTEGER"/>
        <result property="freeDepositType" column="free_deposit_type" jdbcType="INTEGER"/>
        <result property="isOpenInsurance" column="is_open_insurance" jdbcType="INTEGER"/>
        <result property="isOpenCarControl" column="is_open_car_control" jdbcType="INTEGER"/>
        <result property="isZeroDepositAuditEnabled" column="is_zero_deposit_audit_enabled" jdbcType="INTEGER"/>
        <result property="isEnableEsign" column="is_enable_esign" jdbcType="INTEGER"/>
        <result property="lowChargeRate" column="low_charge_rate" jdbcType="DOUBLE"/>
        <result property="fullChargeRate" column="full_charge_rate" jdbcType="DOUBLE"/>
        <result property="chargeRateType" column="charge_rate_type" jdbcType="INTEGER"/>
        <result property="alipayCustomer" column="alipay_customer" jdbcType="INTEGER"/>
        <result property="isEnableMeiTuanRiderMall" column="is_enable_mei_tuan_rider_mall" jdbcType="INTEGER"/>
        <result property="eleLimit" column="ele_limit" jdbcType="INTEGER"/>
        <result property="eleLimitCount" column="ele_limit_count" jdbcType="INTEGER"/>
        <result property="isEnableFlexibleRenewal" column="is_enable_flexible_renewal" jdbcType="INTEGER"/>
        <result property="isEnableSeparateDeposit" column="is_enable_separate_deposit" jdbcType="INTEGER"/>
        <result property="isSwapExchange" column="is_swap_exchange" jdbcType="INTEGER"/>
        <result property="freezeAutoReviewDays" column="freeze_auto_review_days" jdbcType="INTEGER"/>
        <result property="packageFreezeCount" column="package_freeze_count" jdbcType="INTEGER"/>
        <result property="packageFreezeDays" column="package_freeze_days" jdbcType="INTEGER"/>
        <result property="packageFreezeDaysWithAssets" column="package_freeze_days_with_assets" jdbcType="INTEGER"/>
        <result property="expiredProtectionTime" column="expired_protection_time" jdbcType="INTEGER"/>
        <result property="isBindBattery" column="is_bind_battery" jdbcType="INTEGER"/>
    </resultMap>
    
    <!-- 基础字段 -->
    <sql id="selectElectricityConfig">
        select id,
               name,
               create_time,
               update_time,
               order_time,
               is_manual_review,
               tenant_id,
               is_withdraw,
               is_check_battery,
               is_open_door_lock,
               is_battery_review,
               disable_member_card,
               is_low_battery_exchange,
               low_battery_exchange_model,
               is_enable_self_open,
               is_enable_return_box_check,
               move_franchisee_detail,
               is_move_franchisee,
               is_open_insurance,
               free_deposit_type,
               is_open_car_control,
               is_zero_deposit_audit_enabled,
               is_enable_esign,
               low_charge_rate,
               full_charge_rate,
               charge_rate_type,
               alipay_customer,
               is_enable_mei_tuan_rider_mall,
               ele_limit,
               ele_limit_count,
               is_enable_flexible_renewal,
               is_enable_separate_deposit,
               freeze_auto_review_days,
               package_freeze_count,
               package_freeze_days,
               package_freeze_days_with_assets,
               expired_protection_time,
               is_bind_battery
               lost_user_first,
               lost_user_days,
               allow_original_inviter
        from t_electricity_config
    </sql>
    
    <sql id="all">
        id
        ,name,create_time,update_time,order_time,is_manual_review,tenant_id,is_withdraw,is_open_door_lock,
        is_battery_review,disable_member_card,is_low_battery_exchange,low_battery_exchange_model,is_enable_self_open,
        is_enable_return_box_check,is_open_insurance,is_move_franchisee,franchisee_move_info,free_deposit_type,
        is_open_car_battery_bind,is_open_car_control,is_zero_deposit_audit_enabled,is_enable_esign,
        allow_rent_ele,allow_return_ele,allow_freeze_with_assets,is_selection_exchange,low_charge_rate,
        full_charge_rate,channel_time_limit,wx_customer,charge_rate_type,alipay_customer,is_comfort_exchange,priority_exchange_norm,
        is_enable_mei_tuan_rider_mall,ele_limit,ele_limit_count,is_enable_flexible_renewal,is_enable_separate_deposit,is_swap_exchange,
        freeze_auto_review_days,package_freeze_count,package_freeze_days,package_freeze_days_with_assets,expired_protection_time,is_bind_battery,lost_user_first,
       	lost_user_days,allow_original_inviter
    </sql>
    <!--通过主键修改数据-->
    <update id="update">
        update t_electricity_config
        <set>
            <if test="name != null and name != ''">
                name = #{name},
            </if>
            <if test="orderTime != null">
                order_time = #{orderTime},
            </if>
            <if test="isManualReview != null">
                is_manual_review = #{isManualReview},
            </if>
            <if test="isWithdraw != null">
                is_withdraw = #{isWithdraw},
            </if>
            <if test="isOpenDoorLock != null">
                is_open_door_lock = #{isOpenDoorLock},
            </if>
            <if test="isBatteryReview != null">
                is_battery_review = #{isBatteryReview},
            </if>
            <if test="disableMemberCard != null">
                disable_member_card = #{disableMemberCard},
            </if>
            <if test="isLowBatteryExchange != null">
                is_low_battery_exchange = #{isLowBatteryExchange},
            </if>
            <if test="isSelectionExchange != null">
                is_selection_exchange = #{isSelectionExchange},
            </if>
            <if test="lowBatteryExchangeModel != null and lowBatteryExchangeModel != ''">
                low_battery_exchange_model = #{lowBatteryExchangeModel},
            </if>
            <if test="isEnableSelfOpen != null">
                is_enable_self_open = #{isEnableSelfOpen},
            </if>
            <if test="isEnableReturnBoxCheck != null">
                is_enable_return_box_check = #{isEnableReturnBoxCheck},
            </if>
            <if test="isOpenInsurance != null">
                is_open_insurance = #{isOpenInsurance},
            </if>
            <if test="freeDepositType != null">
                free_deposit_type = #{freeDepositType},
            </if>
            <if test="createTime != null">
                create_time = #{createTime},
            </if>
            <if test="updateTime != null">
                update_time = #{updateTime},
            </if>
            <if test="isMoveFranchisee != null">
                is_move_franchisee = #{isMoveFranchisee},
            </if>
            <if test="isOpenCarBatteryBind != null">
                is_open_car_battery_bind = #{isOpenCarBatteryBind},
            </if>
            <if test="isZeroDepositAuditEnabled != null">
                is_zero_deposit_audit_enabled = #{isZeroDepositAuditEnabled},
            </if>
            <if test="isOpenCarControl != null">
                is_open_car_control = #{isOpenCarControl},
            </if>
            <if test="isEnableEsign != null">
                is_enable_esign = #{isEnableEsign},
            </if>
            <if test="allowRentEle != null">
                allow_rent_ele = #{allowRentEle},
            </if>
            <if test="allowReturnEle != null">
                allow_return_ele = #{allowReturnEle},
            </if>
            <if test="allowFreezeWithAssets != null">
                allow_freeze_with_assets = #{allowFreezeWithAssets},
            </if>
            <if test="lowChargeRate != null">
                low_charge_rate = #{lowChargeRate},
            </if>
            <if test="fullChargeRate != null">
                full_charge_rate = #{fullChargeRate},
            </if>
            <if test="channelTimeLimit != null">
                channel_time_limit = #{channelTimeLimit},
            </if>
            <if test="chargeRateType != null">
                charge_rate_type = #{chargeRateType},
            </if>
            <if test="lostUserFirst != null">
                lost_user_first  = #{lostUserFirst},
            </if>
            <if test="lostUserDays != null">
                lost_user_days = #{lostUserDays},
            </if>
            <if test="allowOriginalInviter != null">
                allow_original_inviter = #{allowOriginalInviter},
            </if>
            <if test="alipayCustomer != null">
                alipay_customer = #{alipayCustomer},
            </if>
            <if test="isComfortExchange != null">
                is_comfort_exchange = #{isComfortExchange},
            </if>
            <if test="priorityExchangeNorm != null">
                priority_exchange_norm = #{priorityExchangeNorm},
            </if>
            <if test="isEnableMeiTuanRiderMall != null">
                is_enable_mei_tuan_rider_mall = #{isEnableMeiTuanRiderMall},
            </if>
            <if test="eleLimit != null">
                ele_limit = #{eleLimit},
            </if>
            <if test="eleLimitCount != null">
                ele_limit_count = #{eleLimitCount},
            </if>
            <if test="isEnableFlexibleRenewal != null">
                is_enable_flexible_renewal = #{isEnableFlexibleRenewal},
            </if>
            <if test="isEnableSeparateDeposit != null">
                is_enable_separate_deposit = #{isEnableSeparateDeposit},
            </if>
            <if test="isSwapExchange != null">
                is_swap_exchange = #{isSwapExchange},
            </if>
            <if test="freezeAutoReviewDays != null">
                freeze_auto_review_days = #{freezeAutoReviewDays},
            </if>
            <if test="packageFreezeCount != null">
                package_freeze_count = #{packageFreezeCount},
            </if>
            <if test="packageFreezeDays != null">
                package_freeze_days = #{packageFreezeDays},
            </if>
            <if test="packageFreezeDaysWithAssets != null">
                package_freeze_days_with_assets = #{packageFreezeDaysWithAssets},
            </if>
            <if test="expiredProtectionTime != null">
                expired_protection_time = #{expiredProtectionTime},
            </if>
            <if test="isBindBattery != null">
                is_bind_battery = #{isBindBattery},
            </if>
            franchisee_move_info = #{franchiseeMoveInfo}
        </set>
        where id = #{id} and tenant_id = #{tenantId}
    </update>
    
    <select id="selectElectricityConfigByTenantId" resultMap="ElectricityConfigMap">
        select
        <include refid="all"/>
        from t_electricity_config
        where tenant_id = #{tenantId} limit 1;
    </select>

    <sql id="column" >
         `id` ,
       `name` ,
       `create_time` ,
       `update_time` ,
       `order_time` ,
       `is_manual_review` ,
       `tenant_id` ,
       `is_withdraw`,
        `is_open_door_lock` ,
       `is_battery_review` ,
       `disable_member_card` ,
       `is_low_battery_exchange` ,
       `low_battery_exchange_model` ,
       `is_enable_self_open` ,
       `is_enable_return_box_check` ,
       `is_open_insurance` ,
       `franchisee_move_info` ,
       `is_move_franchisee` ,
       `free_deposit_type` ,
       `is_open_car_battery_bind` ,
       `is_open_car_control` ,
       `is_zero_deposit_audit_enabled` ,
       `is_enable_esign` ,
       `allow_rent_ele` ,
       `allow_return_ele` ,
       `allow_freeze_with_assets` ,
       `is_selection_exchange` ,
       `low_charge_rate` ,
       `full_charge_rate` ,
       `wx_customer` ,
       `enable_offline_power_lock` ,
       `charge_rate_type` ,
       `channel_time_limit` ,
       `is_comfort_exchange` ,
       `priority_exchange_norm`,
       `is_enable_mei_tuan_rider_mall` ,
       `alipay_customer` ,
       `is_enable_flexible_renewal` ,
       `is_enable_separate_deposit` ,
       `ele_limit` ,
       `ele_limit_count` ,
       `freeze_auto_review_days` ,
       `package_freeze_count` ,
       `package_freeze_days` ,
       `package_freeze_days_with_assets` ,
       `expired_protection_time` ,
       `is_swap_exchange` ,
       `is_bind_battery` ,
       `lost_user_first` ,
       `lost_user_days` ,
       `allow_original_inviter`
    </sql>

    <select id="selectByTenantId" resultType="com.xiliulou.electricity.entity.ElectricityConfig">
        select
            <include refid="column"/>
        from t_electricity_config
        where tenant_id = #{tenantId} limit 1;
    </select>

    <update id="updateWxCuStatusByTenantId">
        update t_electricity_config
        <set>
            <if test="updateTime != null">
                update_time = #{updateTime},
            </if>
            <if test="wxCustomer != null">
                wx_customer = #{wxCustomer}
            </if>
        </set>
        where tenant_id = #{tenantId}
    </update>
</mapper>
